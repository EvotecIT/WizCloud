using System.Text.Json.Nodes;

namespace WizCloud;

/// <summary>
/// Represents a package affected by a vulnerability.
/// </summary>
public class WizVulnerabilityPackage {
    /// <summary>
    /// Gets or sets the package name.
    /// </summary>
    public string Name { get; set; } = string.Empty;

    /// <summary>
    /// Gets or sets the package version.
    /// </summary>
    public string? Version { get; set; }

    /// <summary>
    /// Gets or sets the fix version for the package.
    /// </summary>
    public string? FixVersion { get; set; }

    /// <summary>
    /// Creates a <see cref="WizVulnerabilityPackage"/> from JSON.
    /// </summary>
    public static WizVulnerabilityPackage FromJson(JsonNode node) {
        return new WizVulnerabilityPackage {
            Name = node["name"]?.GetValue<string>() ?? string.Empty,
            Version = node["version"]?.GetValue<string>(),
            FixVersion = node["fixVersion"]?.GetValue<string>()
        };
    }
}