using System.Text.Json.Nodes;
using WizCloud;

namespace WizCloud.Tests;

[TestClass]
public sealed class WizVulnerabilityCvssTests {
    [TestMethod]
    public void FromJson_ParsesFields() {
        string jsonString = """
        {
          "score": 9.8,
          "severity": "CRITICAL",
          "vector": "AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
        }
        """;
        JsonNode json = JsonNode.Parse(jsonString)!;
        WizVulnerabilityCvss cvss = WizVulnerabilityCvss.FromJson(json);

        Assert.AreEqual(9.8, cvss.Score);
        Assert.AreEqual(WizSeverity.CRITICAL, cvss.Severity);
        Assert.AreEqual("AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", cvss.Vector);
    }
}
