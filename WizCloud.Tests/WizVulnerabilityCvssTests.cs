using System.Text.Json;
using WizCloud;

namespace WizCloud.Tests;

[TestClass]
public sealed class WizVulnerabilityCvssTests {
    [TestMethod]
    public void Deserialize_ParsesFields() {
        string jsonString = """
        {
          "score": 9.8,
          "severity": "CRITICAL",
          "vector": "AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
        }
        """;
        WizVulnerabilityCvss cvss = JsonSerializer.Deserialize<WizVulnerabilityCvss>(jsonString, TestJson.Options)!;

        Assert.AreEqual(9.8, cvss.Score);
        Assert.AreEqual(WizSeverity.CRITICAL, cvss.Severity);
        Assert.AreEqual("AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", cvss.Vector);
    }
}
