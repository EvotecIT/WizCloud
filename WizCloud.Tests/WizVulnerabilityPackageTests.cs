using System.Text.Json.Nodes;
using WizCloud;

namespace WizCloud.Tests;

[TestClass]
public sealed class WizVulnerabilityPackageTests {
    [TestMethod]
    public void FromJson_ParsesFields() {
        string jsonString = """
        {
          "name": "pkg",
          "version": "1.0",
          "fixVersion": "1.1"
        }
        """;
        JsonNode json = JsonNode.Parse(jsonString)!;
        WizVulnerabilityPackage package = WizVulnerabilityPackage.FromJson(json);

        Assert.AreEqual("pkg", package.Name);
        Assert.AreEqual("1.0", package.Version);
        Assert.AreEqual("1.1", package.FixVersion);
    }
}
